@startuml

rectangle "Copy input from home to scratch" {
caption \lpdsh -R ssh -w $SLURM_JOB_NODELIST "cp -r /home/$USER/input /mnt/scratch/local/$USER/"

rectangle "<b>larcc-cpu1\nExecutes the pdsh command" as job_executor
note right
  This is where slurm executes
  your submission script
end note
rectangle "<b>CARDS 4PB Storage\n/home/$USER" as Shared

rectangle "<b>larcc-cpu1\nExecutes cp command" as Node1 {
  folder "/home/$USER" as Node1Home
  folder "/mnt/scratch/local/$USER" as Node1Scratch
}

rectangle "<b>larcc-cpu2\nExecutes cp command" as Node2 {
  folder "/home/$USER" as Node2Home
  folder "/mnt/scratch/local/$USER" as Node2Scratch
}
rectangle "<b>larcc-cpu3\nExecutes cp command" as Node3 {
  folder "/home/$USER" as Node3Home
  folder "/mnt/scratch/local/$USER" as Node3Scratch
}

job_executor -down-> Node1 : ssh
job_executor -down-> Node2 : ssh
job_executor -down-> Node3 : ssh
Node1Home -down-> Shared
Node2Home -down-> Shared
Node3Home -down-> Shared
}
@enduml
